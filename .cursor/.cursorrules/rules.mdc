---
description: 
globs: 
alwaysApply: false
---

Your **Rent Analysis App** is structured as a **GoSection8-style** platform with key features like rent reasonableness analysis, map integration, legal compliance, PDF generation, AI assistance, authentication, multi-tenant support, and subscription plans.

### **Key Technologies:**
- **Next.js (React-based framework)**
- **Tailwind CSS** (for styling)
- **NextAuth.js** (for authentication)
- **Stripe** (for payments)
- **OpenAI API** (for AI-powered analysis)
- **Puppeteer** (for PDF generation)
- **Nodemailer** (for email handling)
- **Mapbox or Google Maps API** (for location features)

---

## **ğŸ“‚ Project File Structure**
```
rent-analysis-app/
â”œâ”€ pages/
â”‚   â”œâ”€ index.js (Landing page)
â”‚   â”œâ”€ rent-estimate.js (Rent analysis form)
â”‚   â”œâ”€ admin/ (Super-admin pages)
â”‚   â”‚   â””â”€ dashboard.js
â”‚   â”œâ”€ org-admin/ (Tenant admin pages)
â”‚   â”‚   â””â”€ index.js
â”‚   â”œâ”€ auth/
â”‚   â”‚   â””â”€ signin.js
â”‚   â”œâ”€ api/
â”‚   â”‚   â”œâ”€ rent-estimate.js
â”‚   â”‚   â”œâ”€ generate-and-email-report.js
â”‚   â”‚   â”œâ”€ ask-operator.js
â”‚   â”‚   â”œâ”€ contact-sales.js
â”‚   â”‚   â””â”€ auth/
â”‚   â”‚       â””â”€ [...nextauth].js
â”œâ”€ components/
â”‚   â”œâ”€ RentMap.js
â”‚   â”œâ”€ AdBanner.js
â”‚   â””â”€ ...
â”œâ”€ services/
â”‚   â”œâ”€ pdfGenerator.js
â”‚   â”œâ”€ emailService.js
â”‚   â”œâ”€ rentAdjustments.js
â”‚   â”œâ”€ rentAdjustmentsConfig.js
â”‚   â”œâ”€ aiOperator.js
â”‚   â”œâ”€ staticMap.js
â”‚   â””â”€ db.js
â”œâ”€ .env.local
â””â”€ package.json
```

---

## **ğŸ› ï¸ Key Features Breakdown**
### 1ï¸âƒ£ **Rent Analysis API**
- **Front-End:** `/pages/rent-estimate.js`
- **API Endpoint:** `/pages/api/rent-estimate.js`
- Fetches rental comps and calculates estimated rent based on **address, bed/bath, condition, sqft, amenities**.

### 2ï¸âƒ£ **Maps Integration**
- **Interactive Map:** `components/RentMap.js` (Uses **Mapbox API**)
- **Static Map for PDFs:** `services/staticMap.js`

### 3ï¸âƒ£ **Rent Regulations & Adjustments**
- **Rent Caps & Rent Control:** `services/rentRegulations.js`
- **Automated rent adjustments based on:** **bedrooms, baths, amenities, location.**

### 4ï¸âƒ£ **AI-Powered Chat Assistant**
- **LLM-based AI Operator:** `services/aiOperator.js`
- **Handles:** **Data validation, disclaimers, summarization of rental comps.**

### 5ï¸âƒ£ **PDF & Email Generation**
- **PDF Creation with Puppeteer:** `services/pdfGenerator.js`
- **Email Sending with Nodemailer:** `services/emailService.js`

### 6ï¸âƒ£ **User Authentication**
- **NextAuth.js-based Login:** `/pages/api/auth/[...nextauth].js`
- **Google OAuth, Email/Password Authentication**
- **Role-Based Access:** **Admin, Landlord, Multi-Tenant Organizations**

### 7ï¸âƒ£ **Multi-Tenant Support**
- **Each user belongs to an Organization.**
- **Admin Panel:** `/pages/admin/dashboard.js`
- **Org-Specific Data Filters**

### 8ï¸âƒ£ **Subscription & Billing**
- **Stripe Integration**
- **Free, Pro, Enterprise Plans**
- **Usage-Based Billing for Enterprise Users**
- **Custom Stripe Checkout & Invoicing**

---

## **ğŸš€ Next Steps**
1. **Refine DB Schema:** Add tables for **Users, Organizations, Properties, Comps, Transactions.**
2. **Security Enhancements:** Secure **API routes**, validate user roles.
3. **Improve UI/UX:** Build a **dashboard** for **admins, landlords.**
4. **Optimize Performance:** Implement **server-side rendering (SSR) & caching.**
5. **Deployment:** Deploy via **Vercel, AWS, or DigitalOcean.**

---

This blueprint gives you **a solid foundation** to build a **fully functional rental analysis platform.** Let me know if you need **any refinements or code suggestions!** ğŸš€
